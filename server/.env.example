# LabLink Server Configuration
# Copy this file to .env and customize as needed

# ====================================================================================
# SERVER CONFIGURATION
# ====================================================================================
LABLINK_HOST=0.0.0.0
LABLINK_API_PORT=8000
LABLINK_WS_PORT=8001
LABLINK_DEBUG=false
LABLINK_SERVER_NAME=LabLink Server

# ====================================================================================
# DATA STORAGE
# ====================================================================================
LABLINK_DATA_DIR=./data
LABLINK_LOG_DIR=./logs
LABLINK_PROFILE_DIR=./profiles
LABLINK_BUFFER_SIZE=1000
LABLINK_DATA_FORMAT=hdf5
LABLINK_MAX_FILE_SIZE_MB=100
LABLINK_ENABLE_COMPRESSION=true

# ====================================================================================
# EQUIPMENT CONFIGURATION
# ====================================================================================
LABLINK_AUTO_DISCOVER_DEVICES=true
LABLINK_VISA_BACKEND=@py
LABLINK_CONNECTION_TIMEOUT_MS=10000
LABLINK_COMMAND_TIMEOUT_MS=5000

# ====================================================================================
# ERROR HANDLING & RECOVERY
# ====================================================================================
# Automatic Reconnection
LABLINK_ENABLE_AUTO_RECONNECT=true
LABLINK_RECONNECT_ATTEMPTS=3
LABLINK_RECONNECT_DELAY_MS=1000
LABLINK_RECONNECT_BACKOFF_MULTIPLIER=2.0

# Health Monitoring
LABLINK_ENABLE_HEALTH_MONITORING=true
LABLINK_HEALTH_CHECK_INTERVAL_SEC=30

# Command Retry
LABLINK_ENABLE_COMMAND_RETRY=true
LABLINK_MAX_COMMAND_RETRIES=2
LABLINK_RETRY_DELAY_MS=500

# ====================================================================================
# LOGGING CONFIGURATION
# ====================================================================================
LABLINK_LOG_LEVEL=INFO
LABLINK_LOG_FORMAT=text
LABLINK_LOG_TO_FILE=true
LABLINK_LOG_ROTATION_SIZE_MB=10
LABLINK_LOG_RETENTION_DAYS=30
LABLINK_ENABLE_PERFORMANCE_LOGGING=false

# ====================================================================================
# WEBSOCKET CONFIGURATION
# ====================================================================================
LABLINK_WS_MAX_CONNECTIONS=10
LABLINK_WS_HEARTBEAT_INTERVAL_SEC=30
LABLINK_WS_MESSAGE_QUEUE_SIZE=100
LABLINK_WS_COMPRESSION_ENABLED=true

# ====================================================================================
# API CONFIGURATION
# ====================================================================================
LABLINK_ENABLE_CORS=true
LABLINK_CORS_ORIGINS=*
LABLINK_ENABLE_RATE_LIMITING=false
LABLINK_RATE_LIMIT_REQUESTS=100
LABLINK_RATE_LIMIT_WINDOW_SEC=60

# ====================================================================================
# SECURITY
# ====================================================================================
# API Key (uncomment and set for production)
# LABLINK_API_KEY=your-secret-key-here
LABLINK_REQUIRE_AUTHENTICATION=false

# TLS/HTTPS Configuration
LABLINK_ENABLE_TLS=false
# LABLINK_CERT_FILE=/path/to/cert.pem
# LABLINK_KEY_FILE=/path/to/key.pem

# ====================================================================================
# EQUIPMENT PROFILES
# ====================================================================================
LABLINK_ENABLE_PROFILES=true
LABLINK_AUTO_LOAD_PROFILES=true
LABLINK_PROFILE_FORMAT=json

# ====================================================================================
# SAFETY & INTERLOCKS
# ====================================================================================
LABLINK_ENABLE_SAFETY_LIMITS=true
LABLINK_ENFORCE_SLEW_RATE=true
LABLINK_SAFE_STATE_ON_DISCONNECT=true
LABLINK_LOG_SAFETY_EVENTS=true
LABLINK_ALLOW_LIMIT_OVERRIDE=false
LABLINK_EMERGENCY_STOP_TIMEOUT_SEC=300

# ====================================================================================
# EQUIPMENT LOCKS & SESSIONS
# ====================================================================================
# Multi-user equipment access control
LABLINK_ENABLE_EQUIPMENT_LOCKS=true

# Lock timeout (seconds, 0=no timeout)
# Locks auto-release after this period of inactivity
LABLINK_LOCK_TIMEOUT_SEC=300

# Session timeout (seconds, 0=no timeout)
# Client sessions expire after this period of inactivity
LABLINK_SESSION_TIMEOUT_SEC=600

# Lock queue - wait in line when equipment is busy
LABLINK_ENABLE_LOCK_QUEUE=true

# Observer mode - read-only access (doesn't block other observers)
LABLINK_ENABLE_OBSERVER_MODE=true

# Auto-release locks when session ends
LABLINK_AUTO_RELEASE_ON_DISCONNECT=true

# Log lock/unlock events
LABLINK_LOG_LOCK_EVENTS=true

# ====================================================================================
# EQUIPMENT STATE MANAGEMENT
# ====================================================================================
# Enable state capture/restore functionality
LABLINK_ENABLE_STATE_MANAGEMENT=true

# State storage directory
LABLINK_STATE_DIR=./states

# Save states to disk for persistence
LABLINK_ENABLE_STATE_PERSISTENCE=true

# Enable state version tracking
LABLINK_ENABLE_STATE_VERSIONING=true

# Maximum states to keep per equipment (oldest removed when exceeded)
LABLINK_MAX_STATES_PER_EQUIPMENT=100

# Automatically capture state when connecting to equipment
LABLINK_AUTO_CAPTURE_ON_CONNECT=false

# ====================================================================================
# DATA ACQUISITION
# ====================================================================================
# Enable data acquisition system
LABLINK_ENABLE_ACQUISITION=true

# Data export directory
LABLINK_ACQUISITION_EXPORT_DIR=./data/acquisitions

# Default sample rate (Hz)
LABLINK_DEFAULT_SAMPLE_RATE=1.0

# Default circular buffer size (samples per channel)
LABLINK_DEFAULT_BUFFER_SIZE=10000

# Maximum acquisition duration (seconds)
LABLINK_MAX_ACQUISITION_DURATION=3600

# Automatically export data when acquisition stops
LABLINK_AUTO_EXPORT_ON_STOP=false
